<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Store ROI Calculation</title>
    <style>
        /* Include your CSS here */
    </style>
</head>
<body>
    <h1>Smart Store ROI Calculation</h1>
    <form id="roi-form">
        <table>
            <thead>
                <tr>
                    <th>Device Type</th>
                    <th>Default Quantity</th>
                    <th>Custom Quantity</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>RFID Systems</td>
                    <td>100</td>
                    <td><input type="number" name="rfid_quantity" min="0" value="1"></td>
                    <td>Tracks inventory with real-time updates.</td>
                </tr>
                <tr>
                    <td>Smart Shelves</td>
                    <td>50</td>
                    <td><input type="number" name="shelves_quantity" min="0" value="1"></td>
                    <td>Equipped with sensors to monitor stock levels.</td>
                </tr>
                <tr>
                    <td>Smart Checkout Systems</td>
                    <td>20</td>
                    <td><input type="number" name="checkout_quantity" min="0" value="1"></td>
                    <td>Enables seamless cashier-less checkout.</td>
                </tr>
                <tr>
                    <td>Inventory Drones</td>
                    <td>10</td>
                    <td><input type="number" name="drones_quantity" min="0" value="1"></td>
                    <td>Automates inventory counting using drones.</td>
                </tr>
            </tbody>
        </table>
        <label>
            Investment Period (Years):
            <input type="number" name="investment_period" min="1" value="5">
        </label>
        <button type="button" id="calculate-btn">Calculate ROI</button>
    </form>

    <h2>ROI Calculation Results</h2>
    <p><strong>Total Revenue:</strong> <span id="total-revenue">-</span></p>
    <p><strong>Total Cost:</strong> <span id="total-cost">-</span></p>
    <p><strong>Net Return:</strong> <span id="net-return">-</span></p>
    <p><strong>ROI:</strong> <span id="roi-percentage">-</span></p>
</body>
<script>document.getElementById('calculate-btn').addEventListener('click', async (event) => {
    event.preventDefault(); // Prevent form submission

    const data = {
        rfidQuantity: document.querySelector('[name="rfid_quantity"]').value,
        smartShelvesQuantity: document.querySelector('[name="shelves_quantity"]').value,
        smartCheckoutQuantity: document.querySelector('[name="checkout_quantity"]').value,
        inventoryDronesQuantity: document.querySelector('[name="drones_quantity"]').value,
        investmentPeriod: document.querySelector('[name="investment_period"]').value,
    };

    console.log("Data sent to backend:", data);

    try {
        const response = await fetch('/smart-store/calculate-roi', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data),
        });

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const result = await response.json();
        console.log("Received response:", result);

        // Update result fields
        document.getElementById('total-revenue').innerText = `${result.totalRevenue} USD`;
        document.getElementById('total-cost').innerText = `${result.totalCost} USD`;
        document.getElementById('net-return').innerText = `${result.netReturn} USD`;
        document.getElementById('roi-percentage').innerText = `${result.roiPercentage}%`;
        document.getElementById('investment-period-display').innerText = `${result.investmentPeriod} Years`;
    } catch (error) {
        console.error("Error during calculation:", error);
        alert('Failed to calculate ROI. Please try again.');
    }
});

</script>
</html>
